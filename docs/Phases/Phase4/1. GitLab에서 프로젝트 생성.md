# Git 및 GitLab 프로젝트 준비 가이드

## 목표

* GitLab 서버 설치 및 접근 확인
* GitLab 프로젝트 생성 및 Git 연동
* Git 기본 개념 이해 및 브랜치 전략 수립
* 브랜치 기반 개발 워크플로우 확립
* `.gitlab-ci.yml` 자동화를 위한 기반 구축

## 1. 환경 구성 계획

### 역할 및 설치 위치 정리

| 역할 | 위치 | 이유 |
|------|------|------|
| **GitLab 서버** | Guest VM | CI/CD 중심 서버로 지속적으로 실행되어야 함 |
| **GitLab Runner** | Guest VM 또는 별도 VM | GitLab과 통신하여 .gitlab-ci.yml 실행 |
| **OpenStack VM** | 배포 대상 | GitLab에서 생성/제어되는 대상 인프라 |

### 환경별 설치 방침

| 환경 유형 | 설치 위치 | 설명 |
|-----------|-----------|------|
| **Guest VM** | **설치됨** | DevStack 외부의 일반 Ubuntu 서버 (예: 192.168.x.x, 10.0.x.x 등) |
| **OpenStack VM** | **설치하지 않음** | OpenStack 위에 생성한 VM에는 설치하지 않음 |

> **설치 이유**: OpenStack 인스턴스(VM)는 Terraform/Ansible 자동화 대상이지, GitLab CI/CD 시스템 자체가 설치되는 곳이 아님

## 2. GitLab 서버 설치

### 2.1 필수 패키지 설치

```bash
# 필수 패키지 설치
sudo apt update
sudo apt install -y curl openssh-server ca-certificates tzdata perl
```

### 2.2 GitLab 저장소 등록 및 설치

```bash
# GitLab 저장소 등록
curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash

# GitLab 설치 (외부 접속용 포트 설정)
sudo EXTERNAL_URL="http://<your-ip>:8081" apt install gitlab-ce
```

> **주의**: `EXTERNAL_URL`에는 브릿지 IP 또는 공인 IP 입력

### 2.3 네트워크 설정

* OpenStack 보안 그룹에서 8081 포트 허용
* 공유기 사용 시 포트포워딩 설정 필요 (8081 → 해당 VM)

```bash
# 포트 확인
sudo ss -tuln | grep 8081
```

## 3. GitLab 초기 설정

### 3.1 초기 비밀번호 확인

GitLab 설치 후 최초 1회만 사용 가능한 root 비밀번호 확인:

```bash
sudo cat /etc/gitlab/initial_root_password
```

### 3.2 root 계정 패스워드 재설정

root 계정 패스워드를 까먹은 경우 다음 명령어로 재설정:

```bash
sudo gitlab-rake 'gitlab:password:reset[root]'
```

### 3.3 웹 접속 및 초기 설정

1. 웹 브라우저 접속: `http://<your-ip>:8081`
2. root 계정으로 로그인
3. 비밀번호 변경
4. 관리자 설정 완료

## 4. GitLab 프로젝트 생성

### 4.1 웹 인터페이스를 통한 프로젝트 생성

1. GitLab 접속: `http://<your-ip>:8081`
2. root 계정으로 로그인
3. 상단 메뉴 → **New project**
4. **Create blank project** 선택
5. 프로젝트 설정:
   * **Project name**: `openstack-auto`
   * **Visibility**: Private
   * **Create** 클릭
