# Git 기본 개념 및 브랜치 워크플로우 가이드

## 1. Git 기본 개념

### 1.1 Git이란?

* **분산 버전 관리 시스템**
* 커밋 단위로 변경사항 추적
* 브랜치로 실험/개발 분리 가능

### 1.2 브랜치 전략

* `main`: 메인 브랜치 (안정적인 배포용 코드)
* `dev`: 통합 개발 브랜치 (개발 작업용)

### 1.3 기본 명령어

```bash
git checkout <브랜치>     # 브랜치 이동
git checkout -b <브랜치>  # 브랜치 생성 + 이동
```

## 2. 로컬 vs 원격 브랜치 이해

| 구분 | 로컬(Local) | 원격(Remote, GitLab) |
|------|-------------|----------------------|
| **위치** | 내 컴퓨터 | GitLab 서버 (또는 GitHub 등) |
| **브랜치 생성** | 수동으로 직접 생성 | `git push`해야 생김 |
| **변경 내역** | `git commit`으로 기록 | `git push`로 전달해야 반영됨 |
| **동기화** | 명시적으로 fetch/push 필요 | 자동 연동 X |

> **핵심 원칙**: 브랜치 이름이 무엇이든 Git은 `add → commit → push` 순서를 따라야만 변경이 추적되고 반영됨

## 3. 프로젝트 초기 설정 및 GitLab 연동

### 3.1 로컬 프로젝트 초기화

```bash
# 프로젝트 디렉터리 생성 및 이동
mkdir ~/openstack-auto
cd ~/openstack-auto

# Git 저장소 초기화
git init
```

### 3.2 기본 파일 생성

```bash
# 기본 파일들 생성
touch README.md .gitignore

# README.md 작성
echo "# OpenStack 자동화 프로젝트" > README.md

# .gitignore 설정 (Terraform 관련 파일 제외)
echo ".terraform/" >> .gitignore
echo "*.tfstate*" >> .gitignore
echo "*.tfplan" >> .gitignore
echo "*.backup" >> .gitignore
```

### 3.3 브랜치 생성 및 GitLab 연동

```bash
# main 브랜치 생성 및 초기 커밋
git checkout -b main
git add .
git commit -m "init: main"
git remote add origin http://<your-ip>:8081/root/openstack-auto.git
git push -u origin main

# dev 브랜치 생성 및 연동
git checkout -b dev
git add .
git commit -m "init: dev"
git push -u origin dev
```

## 4. 개발 워크플로우

### 4.1 기본 개발 흐름

1. **모든 작업은 `dev` 브랜치에서 진행**
2. **기능 완료 후 `main`으로 병합**
3. **병합 시 코드 리뷰 및 테스트 수행**

### 4.2 일상적인 개발 작업

```bash
# dev 브랜치로 이동 (개발 작업 전)
git checkout dev

# 작업 후 변경사항 저장
git add .
git commit -m "작업 내용 설명"
git push origin dev
```

## 5. 병합(Merge) 작업

### 5.1 Merge Request를 통한 병합 (권장 방법)

**GitLab 웹 인터페이스 사용**:
1. GitLab 접속 → `Merge Requests` → `New merge request`
2. **Source branch**: `dev`
3. **Target branch**: `main`
4. **Create merge request** → **Merge**

**장점**:
- 코드 리뷰 가능
- 변경 이력 추적 용이
- 승인 프로세스 구축 가능

### 5.2 CLI를 통한 직접 병합 (선택사항)

```bash
# main 브랜치로 이동
git checkout main

# 원격 main 브랜치 최신 상태 동기화
git pull origin main

# dev 브랜치 병합
git merge dev

# 변경사항을 원격 저장소에 반영
git push origin main
```

> **중요**: 병합 전 반드시 main 브랜치의 최신 상태를 `pull` 해와야 충돌을 방지할 수 있음

## 6. 브랜치 관리 모범 사례

### 6.1 브랜치 사용 원칙

- **main**: 항상 안정적인 상태 유지
- **dev**: 개발 중인 모든 기능 통합
- **feature branches**: 특정 기능 개발 시 별도 브랜치 생성 고려

### 6.2 커밋 메시지 컨벤션

```bash
# 좋은 예시
git commit -m "feat: OpenStack VM 생성 Terraform 코드 추가"
git commit -m "fix: GitLab CI 스크립트 권한 오류 수정"
git commit -m "docs: README.md 설치 가이드 업데이트"
```

### 6.3 정기적인 동기화

```bash
# 원격 저장소 최신 상태 확인
git fetch origin

# 로컬 브랜치를 원격과 동기화
git pull origin dev  # dev 브랜치에서
git pull origin main # main 브랜치에서
```

## 7. 문제 해결

### 7.1 원격 저장소 URL 변경

Git 원격 저장소의 URL을 올바른 주소로 수정해야 하는 경우:

**현재 원격 저장소 URL 확인**:

```bash
git remote -v
```

이 명령을 실행하면 현재 설정된 원격 저장소의 주소를 확인할 수 있음. 다음과 유사하게 표시됨:

```
origin  http://121.150.14.146:8081/root/openstack-auto.git/ (fetch)
origin  http://121.150.14.146:8081/root/openstack-auto.git/ (push)
```

**원격 저장소 URL 수정**:

`set-url` 명령을 사용하여 origin이라는 이름의 원격 저장소 URL을 올바른 주소로 변경:

```bash
git remote set-url origin http://59.23.151.74:8081/root/openstack-auto.git
```

**변경 확인**:

```bash
git remote -v
```
